# -------------------------------------------------
# 1. Base image (Python 3.12 + pip)
# -------------------------------------------------
FROM agrigorev/zoomcamp-model:2025

# -------------------------------------------------
# 2. Upgrade pip (optional)
# -------------------------------------------------
RUN pip install --upgrade pip

# -------------------------------------------------
# 3. Working directory
# -------------------------------------------------
WORKDIR /app

# -------------------------------------------------
# 4. Install ONLY required packages
# -------------------------------------------------
RUN pip install --no-cache-dir \
    scikit-learn==1.6.1 \
    fastapi \
    uvicorn[standard]

# -------------------------------------------------
# 5. Copy code & model
# -------------------------------------------------
COPY app.py .
COPY pipeline_v1.bin .

# -------------------------------------------------
# 6. Expose port
# -------------------------------------------------
EXPOSE 8000

# -------------------------------------------------
# 7. Run uvicorn â€“ note the module name is "app"
# -------------------------------------------------
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]